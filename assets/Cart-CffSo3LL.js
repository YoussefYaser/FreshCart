import{a as ae,u as Ae,r as c,b as nt,c as ie,j as i,d as S,R as Q,g as St,e as B,f as kt,h as Ot,A as Mt,i as Dt}from"./index-DzTsfExf.js";function Lt(e){let t=localStorage.getItem("user1");return ae.delete(`https://ecommerce.routemisr.com/api/v1/cart/${e}`,{headers:{token:t}})}function $t({id:e,count:t}){let n=localStorage.getItem("user1");return ae.put(`https://ecommerce.routemisr.com/api/v1/cart/${e}`,{count:t},{headers:{token:n}})}function It({elem:e,isFetching:t}){let{noDark:n}=Ae(),[r,o]=c.useState(!1),[s,a]=c.useState(!1),[l,u]=c.useState(!1);c.useEffect(()=>{t||(a(!1),u(!1))},[t]);const d=nt();let{mutate:m,isPending:h,isError:f,error:b}=ie({mutationFn:Lt,retry:3,onSuccess:()=>{d.invalidateQueries({queryKey:["cart"]})},onError:()=>{setTimeout(()=>{o(!0)},2e4),a(!1)}}),{mutate:x,isPending:R,isError:k,error:C}=ie({mutationFn:$t,retry:3,onSuccess:()=>{d.invalidateQueries({queryKey:["cart"]})},onError:()=>{setTimeout(()=>{o(!0)},2e4),u(!1)}});function j(y){m(y),a(!0),o(!1)}function T(y){y=="plus"?x({id:e.product._id,count:e.count+1}):y=="minus"&&(e.count==1?j(e.product.id):x({id:e.product._id,count:e.count-1})),u(!0),o(!1)}return i.jsx(i.Fragment,{children:i.jsxs("tr",{className:`prod border border-2 border-start-0 border-end-0 border-top-0 border-black ${s&&!f&&"opacity-50"}`,children:[i.jsx("td",{className:" py-2 px-1 text-start",children:i.jsx("img",{src:e.product.imageCover,className:` object-fit-cover rounded ${n}`,alt:""})}),i.jsx("td",{className:" py-2 px-1 fs-4",children:i.jsxs("div",{className:" d-flex xy-center position-relative z-0",children:[i.jsx("span",{onClick:()=>T("minus"),className:"minus bg-secondary-subtle rounded-circle d-inline-flex xy-center me-2",style:{width:"25px",height:"25px",cursor:"pointer",fontSize:"12px"},children:i.jsx("i",{className:"fa-solid fa-minus"})}),i.jsx("span",{className:` text-black loader position-absolute top-50 start-50 z-n1 ${(R||t)&&l?"opacity-1":"opacity-0"}`,style:{borderColor:"black",borderBottomColor:"transparent"}}),i.jsx("span",{className:` m-0 ${(R||t)&&l?"opacity-0":"opacity-1"}`,children:e.count}),i.jsx("span",{onClick:()=>T("plus"),className:"plus bg-secondary-subtle rounded-circle d-inline-flex xy-center ms-2",style:{width:"25px",height:"25px",cursor:"pointer",fontSize:"12px"},children:i.jsx("i",{className:"fa-solid fa-plus"})})]})}),i.jsxs("td",{className:" py-2 px-1 fs-4",children:[e.price," EGP"]}),i.jsx("td",{className:" py-2 px-1 fs-4",children:i.jsxs("button",{className:`btn btn-danger text-capitalize position-relative z-0 ${n}`,onClick:()=>j(e.product.id),children:[i.jsxs("p",{className:` m-0 ${(h||t)&&s?"opacity-0":"opacity-1"}`,children:["remove",i.jsx("i",{className:"fa-solid fa-trash ms-2"})]}),i.jsx("span",{className:`loader position-absolute top-50 start-50 z-n1 ${(h||t)&&s?"opacity-1":"opacity-0"}`})]})}),f?i.jsx("span",{className:`error bg-danger p-2 position-absolute rounded text-white ${r&&"opacity-0"}`,children:b.message}):"",k?i.jsx("span",{className:`error bg-danger p-2 position-absolute rounded text-white ${r&&"opacity-0"}`,children:C.message}):""]},e._id)})}const _t=["as","disabled"];function Ft(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function At(e){return!e||e.trim()==="#"}function rt({tagName:e,disabled:t,href:n,target:r,rel:o,role:s,onClick:a,tabIndex:l=0,type:u}){e||(n!=null||r!=null||o!=null?e="a":e="button");const d={tagName:e};if(e==="button")return[{type:u||"button",disabled:t},d];const m=f=>{if((t||e==="a"&&At(n))&&f.preventDefault(),t){f.stopPropagation();return}a==null||a(f)},h=f=>{f.key===" "&&(f.preventDefault(),m(f))};return e==="a"&&(n||(n="#"),t&&(n=void 0)),[{role:s??"button",disabled:void 0,tabIndex:t?void 0:l,href:n,target:e==="a"?r:void 0,"aria-disabled":t||void 0,rel:e==="a"?o:void 0,onClick:m,onKeyDown:h},d]}const Bt=c.forwardRef((e,t)=>{let{as:n,disabled:r}=e,o=Ft(e,_t);const[s,{tagName:a}]=rt(Object.assign({tagName:n,disabled:r},o));return i.jsx(a,Object.assign({},o,s,{ref:t}))});Bt.displayName="Button";const Pt=["xxl","xl","lg","md","sm","xs"],Wt="xs",ot=c.createContext({prefixes:{},breakpoints:Pt,minBreakpoint:Wt});function W(e,t){const{prefixes:n}=c.useContext(ot);return e||n[t]||t}function Ut(){const{dir:e}=c.useContext(ot);return e==="rtl"}const st=c.forwardRef(({as:e,bsPrefix:t,variant:n="primary",size:r,active:o=!1,disabled:s=!1,className:a,...l},u)=>{const d=W(t,"btn"),[m,{tagName:h}]=rt({tagName:e,disabled:s,...l}),f=h;return i.jsx(f,{...m,...l,ref:u,disabled:s,className:S(a,d,o&&"active",n&&`${d}-${n}`,r&&`${d}-${r}`,l.href&&s&&"disabled")})});st.displayName="Button";const Z=!!(typeof window<"u"&&window.document&&window.document.createElement);var Le=!1,$e=!1;try{var we={get passive(){return Le=!0},get once(){return $e=Le=!0}};Z&&(window.addEventListener("test",we,we),window.removeEventListener("test",we,!0))}catch{}function at(e,t,n,r){if(r&&typeof r!="boolean"&&!$e){var o=r.once,s=r.capture,a=n;!$e&&o&&(a=n.__once||function l(u){this.removeEventListener(t,l,s),n.call(this,u)},n.__once=a),e.addEventListener(t,a,Le?r:s)}e.addEventListener(t,n,r)}function be(e){return e&&e.ownerDocument||document}function Ie(e,t,n,r){var o=r&&typeof r!="boolean"?r.capture:r;e.removeEventListener(t,n,o),n.__once&&e.removeEventListener(t,n.__once,o)}var Ee;function Ge(e){if((!Ee&&Ee!==0||e)&&Z){var t=document.createElement("div");t.style.position="absolute",t.style.top="-9999px",t.style.width="50px",t.style.height="50px",t.style.overflow="scroll",document.body.appendChild(t),Ee=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return Ee}function Ht(){return c.useState(null)}function Kt(e){const t=c.useRef(e);return c.useEffect(()=>{t.current=e},[e]),t}function M(e){const t=Kt(e);return c.useCallback(function(...n){return t.current&&t.current(...n)},[t])}const Ve=e=>!e||typeof e=="function"?e:t=>{e.current=t};function zt(e,t){const n=Ve(e),r=Ve(t);return o=>{n&&n(o),r&&r(o)}}function ce(e,t){return c.useMemo(()=>zt(e,t),[e,t])}function Gt(e){const t=c.useRef(e);return t.current=e,t}function it(e){const t=Gt(e);c.useEffect(()=>()=>t.current(),[])}function Vt(e){var t=be(e);return t&&t.defaultView||window}function Xt(e,t){return Vt(e).getComputedStyle(e,t)}var qt=/([A-Z])/g;function Yt(e){return e.replace(qt,"-$1").toLowerCase()}var Qt=/^ms-/;function ge(e){return Yt(e).replace(Qt,"-ms-")}var Zt=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function Jt(e){return!!(e&&Zt.test(e))}function P(e,t){var n="",r="";if(typeof t=="string")return e.style.getPropertyValue(ge(t))||Xt(e).getPropertyValue(ge(t));Object.keys(t).forEach(function(o){var s=t[o];!s&&s!==0?e.style.removeProperty(ge(o)):Jt(o)?r+=o+"("+s+") ":n+=ge(o)+": "+s+";"}),r&&(n+="transform: "+r+";"),e.style.cssText+=";"+n}function ve(e,t,n,r){return at(e,t,n,r),function(){Ie(e,t,n,r)}}function en(e,t,n,r){if(r===void 0&&(r=!0),e){var o=document.createEvent("HTMLEvents");o.initEvent(t,n,r),e.dispatchEvent(o)}}function tn(e){var t=P(e,"transitionDuration")||"",n=t.indexOf("ms")===-1?1e3:1;return parseFloat(t)*n}function nn(e,t,n){n===void 0&&(n=5);var r=!1,o=setTimeout(function(){r||en(e,"transitionend",!0)},t+n),s=ve(e,"transitionend",function(){r=!0},{once:!0});return function(){clearTimeout(o),s()}}function ct(e,t,n,r){n==null&&(n=tn(e)||0);var o=nn(e,n,r),s=ve(e,"transitionend",t);return function(){o(),s()}}function Se(e){e===void 0&&(e=be());try{var t=e.activeElement;return!t||!t.nodeName?null:t}catch{return e.body}}function Xe(e,t){if(e.contains)return e.contains(t);if(e.compareDocumentPosition)return e===t||!!(e.compareDocumentPosition(t)&16)}function rn(){const e=c.useRef(!0),t=c.useRef(()=>e.current);return c.useEffect(()=>(e.current=!0,()=>{e.current=!1}),[]),t.current}function on(e){const t=c.useRef(null);return c.useEffect(()=>{t.current=e}),t.current}const sn="data-rr-ui-";function an(e){return`${sn}${e}`}function cn(e=document){const t=e.defaultView;return Math.abs(t.innerWidth-e.documentElement.clientWidth)}const qe=an("modal-open");class Be{constructor({ownerDocument:t,handleContainerOverflow:n=!0,isRTL:r=!1}={}){this.handleContainerOverflow=n,this.isRTL=r,this.modals=[],this.ownerDocument=t}getScrollbarWidth(){return cn(this.ownerDocument)}getElement(){return(this.ownerDocument||document).body}setModalAttributes(t){}removeModalAttributes(t){}setContainerStyle(t){const n={overflow:"hidden"},r=this.isRTL?"paddingLeft":"paddingRight",o=this.getElement();t.style={overflow:o.style.overflow,[r]:o.style[r]},t.scrollBarWidth&&(n[r]=`${parseInt(P(o,r)||"0",10)+t.scrollBarWidth}px`),o.setAttribute(qe,""),P(o,n)}reset(){[...this.modals].forEach(t=>this.remove(t))}removeContainerStyle(t){const n=this.getElement();n.removeAttribute(qe),Object.assign(n.style,t.style)}add(t){let n=this.modals.indexOf(t);return n!==-1||(n=this.modals.length,this.modals.push(t),this.setModalAttributes(t),n!==0)||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state)),n}remove(t){const n=this.modals.indexOf(t);n!==-1&&(this.modals.splice(n,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(t))}isTopModal(t){return!!this.modals.length&&this.modals[this.modals.length-1]===t}}const lt=c.createContext(Z?window:void 0);lt.Provider;function Pe(){return c.useContext(lt)}const ke=(e,t)=>Z?e==null?(t||be()).body:(typeof e=="function"&&(e=e()),e&&"current"in e&&(e=e.current),e&&("nodeType"in e||e.getBoundingClientRect)?e:null):null;function ln(e,t){const n=Pe(),[r,o]=c.useState(()=>ke(e,n==null?void 0:n.document));if(!r){const s=ke(e);s&&o(s)}return c.useEffect(()=>{},[t,r]),c.useEffect(()=>{const s=ke(e);s!==r&&o(s)},[e,r]),r}const un=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",dn=typeof document<"u",Ye=dn||un?c.useLayoutEffect:c.useEffect;function fn({children:e,in:t,onExited:n,mountOnEnter:r,unmountOnExit:o}){const s=c.useRef(null),a=c.useRef(t),l=M(n);c.useEffect(()=>{t?a.current=!0:l(s.current)},[t,l]);const u=ce(s,e.ref),d=c.cloneElement(e,{ref:u});return t?d:o||!a.current&&r?null:d}function pn(e){return e.code==="Escape"||e.keyCode===27}function mn(){const e=c.version.split(".");return{major:+e[0],minor:+e[1],patch:+e[2]}}const hn=["onEnter","onEntering","onEntered","onExit","onExiting","onExited","addEndListener","children"];function xn(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function En(e){let{onEnter:t,onEntering:n,onEntered:r,onExit:o,onExiting:s,onExited:a,addEndListener:l,children:u}=e,d=xn(e,hn);const{major:m}=mn(),h=m>=19?u.props.ref:u.ref,f=c.useRef(null),b=ce(f,typeof u=="function"?null:h),x=g=>w=>{g&&f.current&&g(f.current,w)},R=c.useCallback(x(t),[t]),k=c.useCallback(x(n),[n]),C=c.useCallback(x(r),[r]),j=c.useCallback(x(o),[o]),T=c.useCallback(x(s),[s]),y=c.useCallback(x(a),[a]),N=c.useCallback(x(l),[l]);return Object.assign({},d,{nodeRef:f},t&&{onEnter:R},n&&{onEntering:k},r&&{onEntered:C},o&&{onExit:j},s&&{onExiting:T},a&&{onExited:y},l&&{addEndListener:N},{children:typeof u=="function"?(g,w)=>u(g,Object.assign({},w,{ref:b})):c.cloneElement(u,{ref:b})})}const gn=["component"];function yn(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}const vn=c.forwardRef((e,t)=>{let{component:n}=e,r=yn(e,gn);const o=En(r);return i.jsx(n,Object.assign({ref:t},o))});function bn({in:e,onTransition:t}){const n=c.useRef(null),r=c.useRef(!0),o=M(t);return Ye(()=>{if(!n.current)return;let s=!1;return o({in:e,element:n.current,initial:r.current,isStale:()=>s}),()=>{s=!0}},[e,o]),Ye(()=>(r.current=!1,()=>{r.current=!0}),[]),n}function Cn({children:e,in:t,onExited:n,onEntered:r,transition:o}){const[s,a]=c.useState(!t);t&&s&&a(!1);const l=bn({in:!!t,onTransition:d=>{const m=()=>{d.isStale()||(d.in?r==null||r(d.element,d.initial):(a(!0),n==null||n(d.element)))};Promise.resolve(o(d)).then(m,h=>{throw d.in||a(!0),h})}}),u=ce(l,e.ref);return s&&!t?null:c.cloneElement(e,{ref:u})}function Qe(e,t,n){return e?i.jsx(vn,Object.assign({},n,{component:e})):t?i.jsx(Cn,Object.assign({},n,{transition:t})):i.jsx(fn,Object.assign({},n))}const Nn=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","runTransition","backdropTransition","runBackdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];function Rn(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}let Oe;function Tn(e){return Oe||(Oe=new Be({ownerDocument:e==null?void 0:e.document})),Oe}function jn(e){const t=Pe(),n=e||Tn(t),r=c.useRef({dialog:null,backdrop:null});return Object.assign(r.current,{add:()=>n.add(r.current),remove:()=>n.remove(r.current),isTopModal:()=>n.isTopModal(r.current),setDialogRef:c.useCallback(o=>{r.current.dialog=o},[]),setBackdropRef:c.useCallback(o=>{r.current.backdrop=o},[])})}const ut=c.forwardRef((e,t)=>{let{show:n=!1,role:r="dialog",className:o,style:s,children:a,backdrop:l=!0,keyboard:u=!0,onBackdropClick:d,onEscapeKeyDown:m,transition:h,runTransition:f,backdropTransition:b,runBackdropTransition:x,autoFocus:R=!0,enforceFocus:k=!0,restoreFocus:C=!0,restoreFocusOptions:j,renderDialog:T,renderBackdrop:y=E=>i.jsx("div",Object.assign({},E)),manager:N,container:g,onShow:w,onHide:J=()=>{},onExit:Ce,onExited:ee,onExiting:le,onEnter:ue,onEntering:de,onEntered:fe}=e,Ne=Rn(e,Nn);const L=Pe(),U=ln(g),v=jn(N),Re=rn(),pe=on(n),[_,H]=c.useState(!n),O=c.useRef(null);c.useImperativeHandle(t,()=>v,[v]),Z&&!pe&&n&&(O.current=Se(L==null?void 0:L.document)),n&&_&&H(!1);const $=M(()=>{if(v.add(),K.current=ve(document,"keydown",je),ne.current=ve(document,"focus",()=>setTimeout(Te),!0),w&&w(),R){var E,xe;const oe=Se((E=(xe=v.dialog)==null?void 0:xe.ownerDocument)!=null?E:L==null?void 0:L.document);v.dialog&&oe&&!Xe(v.dialog,oe)&&(O.current=oe,v.dialog.focus())}}),te=M(()=>{if(v.remove(),K.current==null||K.current(),ne.current==null||ne.current(),C){var E;(E=O.current)==null||E.focus==null||E.focus(j),O.current=null}});c.useEffect(()=>{!n||!U||$()},[n,U,$]),c.useEffect(()=>{_&&te()},[_,te]),it(()=>{te()});const Te=M(()=>{if(!k||!Re()||!v.isTopModal())return;const E=Se(L==null?void 0:L.document);v.dialog&&E&&!Xe(v.dialog,E)&&v.dialog.focus()}),me=M(E=>{E.target===E.currentTarget&&(d==null||d(E),l===!0&&J())}),je=M(E=>{u&&pn(E)&&v.isTopModal()&&(m==null||m(E),E.defaultPrevented||J())}),ne=c.useRef(),K=c.useRef(),he=(...E)=>{H(!0),ee==null||ee(...E)};if(!U)return null;const z=Object.assign({role:r,ref:v.setDialogRef,"aria-modal":r==="dialog"?!0:void 0},Ne,{style:s,className:o,tabIndex:-1});let re=T?T(z):i.jsx("div",Object.assign({},z,{children:c.cloneElement(a,{role:"document"})}));re=Qe(h,f,{unmountOnExit:!0,mountOnEnter:!0,appear:!0,in:!!n,onExit:Ce,onExiting:le,onExited:he,onEnter:ue,onEntering:de,onEntered:fe,children:re});let G=null;return l&&(G=y({ref:v.setBackdropRef,onClick:me}),G=Qe(b,x,{in:!!n,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:G})),i.jsx(i.Fragment,{children:Q.createPortal(i.jsxs(i.Fragment,{children:[G,re]}),U)})});ut.displayName="Modal";const wn=Object.assign(ut,{Manager:Be});function Sn(e,t){return e.classList?e.classList.contains(t):(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")!==-1}function kn(e,t){e.classList?e.classList.add(t):Sn(e,t)||(typeof e.className=="string"?e.className=e.className+" "+t:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+t))}var On=Function.prototype.bind.call(Function.prototype.call,[].slice);function X(e,t){return On(e.querySelectorAll(t))}function Ze(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function Mn(e,t){e.classList?e.classList.remove(t):typeof e.className=="string"?e.className=Ze(e.className,t):e.setAttribute("class",Ze(e.className&&e.className.baseVal||"",t))}const q={FIXED_CONTENT:".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",STICKY_CONTENT:".sticky-top",NAVBAR_TOGGLER:".navbar-toggler"};class Dn extends Be{adjustAndStore(t,n,r){const o=n.style[t];n.dataset[t]=o,P(n,{[t]:`${parseFloat(P(n,t))+r}px`})}restore(t,n){const r=n.dataset[t];r!==void 0&&(delete n.dataset[t],P(n,{[t]:r}))}setContainerStyle(t){super.setContainerStyle(t);const n=this.getElement();if(kn(n,"modal-open"),!t.scrollBarWidth)return;const r=this.isRTL?"paddingLeft":"paddingRight",o=this.isRTL?"marginLeft":"marginRight";X(n,q.FIXED_CONTENT).forEach(s=>this.adjustAndStore(r,s,t.scrollBarWidth)),X(n,q.STICKY_CONTENT).forEach(s=>this.adjustAndStore(o,s,-t.scrollBarWidth)),X(n,q.NAVBAR_TOGGLER).forEach(s=>this.adjustAndStore(o,s,t.scrollBarWidth))}removeContainerStyle(t){super.removeContainerStyle(t);const n=this.getElement();Mn(n,"modal-open");const r=this.isRTL?"paddingLeft":"paddingRight",o=this.isRTL?"marginLeft":"marginRight";X(n,q.FIXED_CONTENT).forEach(s=>this.restore(r,s)),X(n,q.STICKY_CONTENT).forEach(s=>this.restore(o,s)),X(n,q.NAVBAR_TOGGLER).forEach(s=>this.restore(o,s))}}let Me;function Ln(e){return Me||(Me=new Dn(e)),Me}function $n(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}function _e(e,t){return _e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},_e(e,t)}function In(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_e(e,t)}var dt={exports:{}},_n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Fn=_n,An=Fn;function ft(){}function pt(){}pt.resetWarningCache=ft;var Bn=function(){function e(r,o,s,a,l,u){if(u!==An){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:pt,resetWarningCache:ft};return n.PropTypes=n,n};dt.exports=Bn();var Pn=dt.exports;const De=St(Pn),Je={disabled:!1},mt=B.createContext(null);var Wn=function(t){return t.scrollTop},se="unmounted",F="exited",I="entering",A="entered",Fe="exiting",D=function(e){In(t,e);function t(r,o){var s;s=e.call(this,r,o)||this;var a=o,l=a&&!a.isMounting?r.enter:r.appear,u;return s.appearStatus=null,r.in?l?(u=F,s.appearStatus=I):u=A:r.unmountOnExit||r.mountOnEnter?u=se:u=F,s.state={status:u},s.nextCallback=null,s}t.getDerivedStateFromProps=function(o,s){var a=o.in;return a&&s.status===se?{status:F}:null};var n=t.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(o){var s=null;if(o!==this.props){var a=this.state.status;this.props.in?a!==I&&a!==A&&(s=I):(a===I||a===A)&&(s=Fe)}this.updateStatus(!1,s)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var o=this.props.timeout,s,a,l;return s=a=l=o,o!=null&&typeof o!="number"&&(s=o.exit,a=o.enter,l=o.appear!==void 0?o.appear:a),{exit:s,enter:a,appear:l}},n.updateStatus=function(o,s){if(o===void 0&&(o=!1),s!==null)if(this.cancelNextCallback(),s===I){if(this.props.unmountOnExit||this.props.mountOnEnter){var a=this.props.nodeRef?this.props.nodeRef.current:Q.findDOMNode(this);a&&Wn(a)}this.performEnter(o)}else this.performExit();else this.props.unmountOnExit&&this.state.status===F&&this.setState({status:se})},n.performEnter=function(o){var s=this,a=this.props.enter,l=this.context?this.context.isMounting:o,u=this.props.nodeRef?[l]:[Q.findDOMNode(this),l],d=u[0],m=u[1],h=this.getTimeouts(),f=l?h.appear:h.enter;if(!o&&!a||Je.disabled){this.safeSetState({status:A},function(){s.props.onEntered(d)});return}this.props.onEnter(d,m),this.safeSetState({status:I},function(){s.props.onEntering(d,m),s.onTransitionEnd(f,function(){s.safeSetState({status:A},function(){s.props.onEntered(d,m)})})})},n.performExit=function(){var o=this,s=this.props.exit,a=this.getTimeouts(),l=this.props.nodeRef?void 0:Q.findDOMNode(this);if(!s||Je.disabled){this.safeSetState({status:F},function(){o.props.onExited(l)});return}this.props.onExit(l),this.safeSetState({status:Fe},function(){o.props.onExiting(l),o.onTransitionEnd(a.exit,function(){o.safeSetState({status:F},function(){o.props.onExited(l)})})})},n.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(o,s){s=this.setNextCallback(s),this.setState(o,s)},n.setNextCallback=function(o){var s=this,a=!0;return this.nextCallback=function(l){a&&(a=!1,s.nextCallback=null,o(l))},this.nextCallback.cancel=function(){a=!1},this.nextCallback},n.onTransitionEnd=function(o,s){this.setNextCallback(s);var a=this.props.nodeRef?this.props.nodeRef.current:Q.findDOMNode(this),l=o==null&&!this.props.addEndListener;if(!a||l){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var u=this.props.nodeRef?[this.nextCallback]:[a,this.nextCallback],d=u[0],m=u[1];this.props.addEndListener(d,m)}o!=null&&setTimeout(this.nextCallback,o)},n.render=function(){var o=this.state.status;if(o===se)return null;var s=this.props,a=s.children;s.in,s.mountOnEnter,s.unmountOnExit,s.appear,s.enter,s.exit,s.timeout,s.addEndListener,s.onEnter,s.onEntering,s.onEntered,s.onExit,s.onExiting,s.onExited,s.nodeRef;var l=$n(s,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return B.createElement(mt.Provider,{value:null},typeof a=="function"?a(o,l):B.cloneElement(B.Children.only(a),l))},t}(B.Component);D.contextType=mt;D.propTypes={};function Y(){}D.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Y,onEntering:Y,onEntered:Y,onExit:Y,onExiting:Y,onExited:Y};D.UNMOUNTED=se;D.EXITED=F;D.ENTERING=I;D.ENTERED=A;D.EXITING=Fe;function et(e,t){const n=P(e,t)||"",r=n.indexOf("ms")===-1?1e3:1;return parseFloat(n)*r}function Un(e,t){const n=et(e,"transitionDuration"),r=et(e,"transitionDelay"),o=ct(e,s=>{s.target===e&&(o(),t(s))},n+r)}function Hn(e){e.offsetHeight}function Kn(e){return e&&"setState"in e?Q.findDOMNode(e):e??null}const zn=B.forwardRef(({onEnter:e,onEntering:t,onEntered:n,onExit:r,onExiting:o,onExited:s,addEndListener:a,children:l,childRef:u,...d},m)=>{const h=c.useRef(null),f=ce(h,u),b=g=>{f(Kn(g))},x=g=>w=>{g&&h.current&&g(h.current,w)},R=c.useCallback(x(e),[e]),k=c.useCallback(x(t),[t]),C=c.useCallback(x(n),[n]),j=c.useCallback(x(r),[r]),T=c.useCallback(x(o),[o]),y=c.useCallback(x(s),[s]),N=c.useCallback(x(a),[a]);return i.jsx(D,{ref:m,...d,onEnter:R,onEntered:C,onEntering:k,onExit:j,onExited:y,onExiting:T,addEndListener:N,nodeRef:h,children:typeof l=="function"?(g,w)=>l(g,{...w,ref:b}):B.cloneElement(l,{ref:b})})}),Gn={[I]:"show",[A]:"show"},We=c.forwardRef(({className:e,children:t,transitionClasses:n={},onEnter:r,...o},s)=>{const a={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1,...o},l=c.useCallback((u,d)=>{Hn(u),r==null||r(u,d)},[r]);return i.jsx(zn,{ref:s,addEndListener:Un,...a,onEnter:l,childRef:t.ref,children:(u,d)=>c.cloneElement(t,{...d,className:S("fade",e,t.props.className,Gn[u],n[u])})})});We.displayName="Fade";const ht=c.forwardRef(({className:e,bsPrefix:t,as:n="div",...r},o)=>(t=W(t,"modal-body"),i.jsx(n,{ref:o,className:S(e,t),...r})));ht.displayName="ModalBody";const xt=c.createContext({onHide(){}}),Ue=c.forwardRef(({bsPrefix:e,className:t,contentClassName:n,centered:r,size:o,fullscreen:s,children:a,scrollable:l,...u},d)=>{e=W(e,"modal");const m=`${e}-dialog`,h=typeof s=="string"?`${e}-fullscreen-${s}`:`${e}-fullscreen`;return i.jsx("div",{...u,ref:d,className:S(m,t,o&&`${e}-${o}`,r&&`${m}-centered`,l&&`${m}-scrollable`,s&&h),children:i.jsx("div",{className:S(`${e}-content`,n),children:a})})});Ue.displayName="ModalDialog";const Et=c.forwardRef(({className:e,bsPrefix:t,as:n="div",...r},o)=>(t=W(t,"modal-footer"),i.jsx(n,{ref:o,className:S(e,t),...r})));Et.displayName="ModalFooter";const Vn={"aria-label":De.string,onClick:De.func,variant:De.oneOf(["white"])},He=c.forwardRef(({className:e,variant:t,"aria-label":n="Close",...r},o)=>i.jsx("button",{ref:o,type:"button",className:S("btn-close",t&&`btn-close-${t}`,e),"aria-label":n,...r}));He.displayName="CloseButton";He.propTypes=Vn;const Xn=c.forwardRef(({closeLabel:e="Close",closeVariant:t,closeButton:n=!1,onHide:r,children:o,...s},a)=>{const l=c.useContext(xt),u=M(()=>{l==null||l.onHide(),r==null||r()});return i.jsxs("div",{ref:a,...s,children:[o,n&&i.jsx(He,{"aria-label":e,variant:t,onClick:u})]})}),gt=c.forwardRef(({bsPrefix:e,className:t,closeLabel:n="Close",closeButton:r=!1,...o},s)=>(e=W(e,"modal-header"),i.jsx(Xn,{ref:s,...o,className:S(t,e),closeLabel:n,closeButton:r})));gt.displayName="ModalHeader";const qn=e=>c.forwardRef((t,n)=>i.jsx("div",{...t,ref:n,className:S(t.className,e)})),Yn=qn("h4"),yt=c.forwardRef(({className:e,bsPrefix:t,as:n=Yn,...r},o)=>(t=W(t,"modal-title"),i.jsx(n,{ref:o,className:S(e,t),...r})));yt.displayName="ModalTitle";function Qn(e){return i.jsx(We,{...e,timeout:null})}function Zn(e){return i.jsx(We,{...e,timeout:null})}const vt=c.forwardRef(({bsPrefix:e,className:t,style:n,dialogClassName:r,contentClassName:o,children:s,dialogAs:a=Ue,"data-bs-theme":l,"aria-labelledby":u,"aria-describedby":d,"aria-label":m,show:h=!1,animation:f=!0,backdrop:b=!0,keyboard:x=!0,onEscapeKeyDown:R,onShow:k,onHide:C,container:j,autoFocus:T=!0,enforceFocus:y=!0,restoreFocus:N=!0,restoreFocusOptions:g,onEntered:w,onExit:J,onExiting:Ce,onEnter:ee,onEntering:le,onExited:ue,backdropClassName:de,manager:fe,...Ne},L)=>{const[U,v]=c.useState({}),[Re,pe]=c.useState(!1),_=c.useRef(!1),H=c.useRef(!1),O=c.useRef(null),[$,te]=Ht(),Te=ce(L,te),me=M(C),je=Ut();e=W(e,"modal");const ne=c.useMemo(()=>({onHide:me}),[me]);function K(){return fe||Ln({isRTL:je})}function he(p){if(!Z)return;const V=K().getScrollbarWidth()>0,ze=p.scrollHeight>be(p).documentElement.clientHeight;v({paddingRight:V&&!ze?Ge():void 0,paddingLeft:!V&&ze?Ge():void 0})}const z=M(()=>{$&&he($.dialog)});it(()=>{Ie(window,"resize",z),O.current==null||O.current()});const re=()=>{_.current=!0},G=p=>{_.current&&$&&p.target===$.dialog&&(H.current=!0),_.current=!1},E=()=>{pe(!0),O.current=ct($.dialog,()=>{pe(!1)})},xe=p=>{p.target===p.currentTarget&&E()},oe=p=>{if(b==="static"){xe(p);return}if(H.current||p.target!==p.currentTarget){H.current=!1;return}C==null||C()},bt=p=>{x?R==null||R(p):(p.preventDefault(),b==="static"&&E())},Ct=(p,V)=>{p&&he(p),ee==null||ee(p,V)},Nt=p=>{O.current==null||O.current(),J==null||J(p)},Rt=(p,V)=>{le==null||le(p,V),at(window,"resize",z)},Tt=p=>{p&&(p.style.display=""),ue==null||ue(p),Ie(window,"resize",z)},jt=c.useCallback(p=>i.jsx("div",{...p,className:S(`${e}-backdrop`,de,!f&&"show")}),[f,de,e]),Ke={...n,...U};Ke.display="block";const wt=p=>i.jsx("div",{role:"dialog",...p,style:Ke,className:S(t,e,Re&&`${e}-static`,!f&&"show"),onClick:b?oe:void 0,onMouseUp:G,"data-bs-theme":l,"aria-label":m,"aria-labelledby":u,"aria-describedby":d,children:i.jsx(a,{...Ne,onMouseDown:re,className:r,contentClassName:o,children:s})});return i.jsx(xt.Provider,{value:ne,children:i.jsx(wn,{show:h,ref:Te,backdrop:b,container:j,keyboard:!0,autoFocus:T,enforceFocus:y,restoreFocus:N,restoreFocusOptions:g,onEscapeKeyDown:bt,onShow:k,onHide:C,onEnter:Ct,onEntering:Rt,onEntered:w,onExit:Nt,onExiting:Ce,onExited:Tt,manager:K(),transition:f?Qn:void 0,backdropTransition:f?Zn:void 0,renderBackdrop:jt,renderDialog:wt})})});vt.displayName="Modal";const ye=Object.assign(vt,{Body:ht,Header:gt,Title:yt,Footer:Et,Dialog:Ue,TRANSITION_DURATION:300,BACKDROP_TRANSITION_DURATION:150});function tt({button:e,cartId:t}){let{noDark:n}=Ae();const[r,o]=c.useState(!1),s=()=>o(!1),a=()=>o(!0),l=localStorage.getItem("user1");function u({cartId:N,values:g}){return ae.post(`https://ecommerce.routemisr.com/api/v1/orders/checkout-session/${N}?url=http://localhost:5174`,{shippingAddress:g},{headers:{token:l}})}function d({cartId:N,values:g}){return ae.post(`https://ecommerce.routemisr.com/api/v1/orders/${N}`,{shippingAddress:g},{headers:{token:l}})}let{mutate:m,data:h,isError:f,error:b,isSuccess:x}=ie({mutationFn:u}),{mutate:R,data:k,isError:C,error:j,isSuccess:T}=ie({mutationFn:d});x&&(window.location.href=h.data.session.url),T&&console.log(k);const y=kt({initialValues:{details:"",phone:"",city:""},onSubmit:N=>{e=="online"?m({cartId:t,values:N}):e=="cash"&&R({cartId:t,values:N})}});return i.jsxs(i.Fragment,{children:[i.jsxs(st,{className:`btn-online me-3 ${n}`,variant:"primary",onClick:a,children:["Pay ",e]}),f?b.message:"",C?j.message:"",i.jsxs(ye,{show:r,onHide:s,className:"modal",children:[i.jsx(ye.Header,{closeButton:!0,className:""}),i.jsx(ye.Body,{children:i.jsxs("form",{action:"",onSubmit:y.handleSubmit,children:[i.jsx("label",{htmlFor:"details",children:"Details"}),i.jsx("input",{type:"text",className:` form-control mb-3 ${n}`,id:"details",onChange:y.handleChange}),i.jsx("label",{htmlFor:"phone",children:"City"}),i.jsx("input",{type:"text",className:` form-control mb-3 ${n}`,id:"phone",onChange:y.handleChange}),i.jsx("label",{htmlFor:"city",children:"Phone"}),i.jsx("input",{type:"text",className:` form-control ${n}`,id:"city",onChange:y.handleChange}),i.jsx(ye.Footer,{className:" mt-4 py-2 px-0",children:i.jsx("button",{type:"submit",className:`btn-submit p-2 ${n}`,children:"Submit"})})]})})]})]})}function Jn(){const e=localStorage.getItem("user1");return ae.delete("https://ecommerce.routemisr.com/api/v1/cart",{headers:{token:e}})}function tr(){let{noDark:e}=Ae();const t=nt();let{isLoading:n,isFetching:r,isError:o,error:s,data:a}=Ot({queryKey:["cart"],queryFn:Dt,select:d=>d==null?void 0:d.data,gcTime:0,refetchOnWindowFocus:!1}),{mutate:l,isPending:u}=ie({mutationFn:Jn,onSuccess:()=>{t.invalidateQueries({queryKey:["cart"]})}});return n?i.jsx("div",{className:"py-5",children:i.jsx(Mt,{})}):o?i.jsx("div",{className:"cart py-5",children:i.jsx("div",{className:"container",children:s.message})}):i.jsx("div",{className:"cart py-5",children:i.jsxs("div",{className:"container",children:[i.jsxs("div",{className:" fs-5",children:["Number of cart items :",i.jsx("p",{className:`text-green d-inline-block fw-bold ms-3 ${e}`,children:a==null?void 0:a.numOfCartItems})]}),i.jsxs("div",{className:" fs-5 mb-4",children:["Total price :",i.jsxs("p",{className:`text-green d-inline-block fw-bold ms-3 ${e}`,children:[a==null?void 0:a.data.totalCartPrice," EGP"]})]}),a!=null&&a.data.products.length?i.jsxs("button",{className:` btn btn-danger position-relative z-0 ${e}`,onClick:()=>l(),children:[i.jsx("span",{className:`${u||r?"opacity-0":"opacity-1"}`,children:"Delete cart"}),i.jsx("span",{className:`loader position-absolute top-50 start-50 z-n1 ${u||r?"opacity-1":"opacity-0"}`})]}):"",i.jsxs("table",{className:" w-100 position-relative mt-4",children:[i.jsx("thead",{className:" text-center text-capitalize border  border-2 border-start-0 border-end-0 border-top-0 border-black",children:i.jsxs("tr",{children:[i.jsx("th",{className:" py-2 px-1",children:"product"}),i.jsx("th",{className:" py-2 px-1",children:"QTY"}),i.jsx("th",{className:" py-2 px-1",children:"price"}),i.jsx("th",{className:" py-2 px-1",children:"action"})]})}),i.jsx("tbody",{className:" text-center",children:a==null?void 0:a.data.products.map(d=>i.jsx(It,{elem:d,isFetching:r},d.product._id))})]}),i.jsxs("div",{className:"payment mt-4",children:[i.jsx(tt,{button:"online",cartId:a==null?void 0:a.cartId}),i.jsx(tt,{button:"cash",cartId:a==null?void 0:a.cartId})]})]})})}export{tr as default};
